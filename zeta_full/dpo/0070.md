<events>
User edited "crates/language/src/buffer.rs":
```diff
@@ -620,6 +620,8 @@
             cx,
         )
     }
+    
+    pub
 
     fn highlight_edits_in_range(
         &self,

```
</events>
<input>
```zed/crates/language/src/buffer.rs
#[derive(Clone)]
pub struct EditPreview {
    old_snapshot: text::BufferSnapshot,
    applied_edits_snapshot: text::BufferSnapshot,
    syntax_snapshot: SyntaxSnapshot,
}

#[derive(Default, Clone, Debug)]
pub struct HighlightedEdits {
    pub text: SharedString,
    pub highlights: Vec<(Range<usize>, HighlightStyle)>,
}

impl EditPreview {
    pub fn highlight_edits(
        &self,
        current_snapshot: &BufferSnapshot,
        edits: &[(Range<Anchor>, String)],
<|editable_region_start|>
        include_deletions: bool,
        cx: &App,
    ) -> HighlightedEdits {
        let Some(visible_range_in_preview_snapshot) = self.compute_visible_range(edits) else {
            return HighlightedEdits::default();
        };
        highlight_edits_in_range(
            current_snapshot,
            visible_range_in_preview_snapshot,
            edits,
            include_deletions,
            cx,
        )
    }
    
    pub<|user_cursor_is_here|>

    fn highlight_edits_in_range(
        &self,
        current_snapshot: &BufferSnapshot,
        visible_range_in_preview_snapshot: Range<usize>,
        edits: &[(Range<Anchor>, String)],
        include_deletions: bool,
        cx: &App,
    ) -> HighlightedEdits {
        let mut text = String::new();
        let mut highlights = Vec::new();

        let mut offset_in_preview_snapshot = visible_range_in_preview_snapshot.start;

        let insertion_highlight_style = HighlightStyle {
            background_color: Some(cx.theme().status().created_background),
            ..Default::default()
        };
        let deletion_highlight_style = HighlightStyle {
<|editable_region_end|>
            background_color: Some(cx.theme().status().deleted_background),
            ..Default::default()
        };

        for (range, edit_text) in edits {
            let edit_new_end_in_preview_snapshot = range
                .end
                .bias_right(&self.old_snapshot)
                .to_offset(&self.applied_edits_snapshot);
            let edit_start_in_preview_snapshot = edit_new_end_in_preview_snapshot - edit_text.len();

            if visible_range_in_preview_snapshot.end < edit_start_in_preview_snapshot {
                break;
            }
```
</input>
<output>
```zed/crates/language/src/buffer.rs
#[derive(Clone)]
pub struct EditPreview {
    old_snapshot: text::BufferSnapshot,
    applied_edits_snapshot: text::BufferSnapshot,
    syntax_snapshot: SyntaxSnapshot,
}

#[derive(Default, Clone, Debug)]
pub struct HighlightedEdits {
    pub text: SharedString,
    pub highlights: Vec<(Range<usize>, HighlightStyle)>,
}

impl EditPreview {
    pub fn highlight_edits(
        &self,
        current_snapshot: &BufferSnapshot,
        edits: &[(Range<Anchor>, String)],
<|editable_region_start|>
        include_deletions: bool,
        cx: &App,
    ) -> HighlightedEdits {
        let Some(visible_range_in_preview_snapshot) = self.compute_visible_range(edits) else {
            return HighlightedEdits::default();
        };
        highlight_edits_in_range(
            current_snapshot,
            visible_range_in_preview_snapshot,
            edits,
            include_deletions,
            cx,
        )
    }
    
    pub fn 
    
    fn highlight_edits_in_range(
        &self,
        current_snapshot: &BufferSnapshot,
        visible_range_in_preview_snapshot: Range<usize>,
        edits: &[(Range<Anchor>, String)],
        include_deletions: bool,
        cx: &App,
    ) -> HighlightedEdits {
        let mut text = String::new();
        let mut highlights = Vec::new();

        let mut offset_in_preview_snapshot = visible_range_in_preview_snapshot.start;

        let insertion_highlight_style = HighlightStyle {
            background_color: Some(cx.theme().status().created_background),
            ..Default::default()
        };
        let deletion_highlight_style = HighlightStyle {
<|editable_region_end|>
            background_color: Some(cx.theme().status().deleted_background),
            ..Default::default()
        };

        for (range, edit_text) in edits {
            let edit_new_end_in_preview_snapshot = range
                .end
                .bias_right(&self.old_snapshot)
                .to_offset(&self.applied_edits_snapshot);
            let edit_start_in_preview_snapshot = edit_new_end_in_preview_snapshot - edit_text.len();

            if visible_range_in_preview_snapshot.end < edit_start_in_preview_snapshot {
                break;
            }
```
</output>
<outline>
```crates/language/src/buffer.rs
pub static BUFFER_DIFF_TASK
pub enum Capability
 ReadWrite
 ReadOnly
pub type BufferRow
pub struct Buffer
 text
 branch_state
 file
 saved_mtime
 saved_version
 preview_version
 transaction_depth
 was_dirty_before_starting_transaction
 reload_task
 language
 autoindent_requests
 pending_autoindent
 sync_parse_timeout
 syntax_map
 parsing_in_background
 parse_status
 non_text_state_update_count
 diagnostics
 remote_selections
 diagnostics_timestamp
 completion_triggers
 completion_triggers_per_language_server
 completion_triggers_timestamp
 deferred_ops
 capability
 has_conflict
 has_unsaved_edits
 _subscriptions
pub enum ParseStatus
 Idle
 Parsing
struct BufferBranchState
 base_buffer
 merged_operations
pub struct BufferSnapshot
 pub text
 pub(crate) syntax
 file
 diagnostics
 remote_selections
 language
 non_text_state_update_count
pub struct IndentSize
 pub len
 pub kind
pub enum IndentKind
 Space
 Tab
pub enum CursorShape
 Bar
 Block
 Underline
 Hollow
struct SelectionSet
 line_mode
 cursor_shape
 selections
 lamport_timestamp
pub struct Diagnostic
 pub source
 pub code
 pub severity
 pub message
 pub group_id
 pub is_primary
 pub is_disk_based
 pub is_unnecessary
 pub data
pub async fn prepare_completion_documentation
pub enum Documentation
 Undocumented
 SingleLine
 MultiLinePlainText
 MultiLineMarkdown
pub enum Operation
 Buffer
 UpdateDiagnostics
  server_id
  diagnostics
  lamport_timestamp
 UpdateSelections
  selections
  lamport_timestamp
  line_mode
  cursor_shape
 UpdateCompletionTriggers
  triggers
  lamport_timestamp
  server_id
pub enum BufferEvent
 Operation
  operation
  is_local
 Edited
 DirtyChanged
 Saved
 FileHandleChanged
 Reloaded
 ReloadNeeded
 LanguageChanged
 Reparsed
 DiagnosticsUpdated
 CapabilityChanged
 Closed
 Discarded
pub trait File
 fn as_local
 fn is_local
 fn disk_state
 fn path
 fn full_path
 fn file_name
 fn worktree_id
 fn as_any
 fn to_proto
 fn is_private
pub enum DiskState
 New
 Present
  mtime
 Deleted
impl DiskState
 pub fn mtime
pub trait LocalFile
 fn abs_path
 fn load
 fn load_bytes
pub enum AutoindentMode
 EachLine
 Block
  original_indent_columns
struct AutoindentRequest
 before_edit
 entries
 is_block_mode
 ignore_empty_lines
struct AutoindentRequestEntry
 range
 first_line_is_new
 indent_size
 original_indent_column
struct IndentSuggestion
 basis_row
 delta
 within_error
struct BufferChunkHighlights
 captures
 next_capture
 stack
 highlight_maps
pub struct BufferChunks
 buffer_snapshot
 range
 chunks
 diagnostic_endpoints
 error_depth
 warning_depth
 information_depth
 hint_depth
 unnecessary_depth
 highlights
pub struct Chunk
 pub text
 pub syntax_highlight_id
 pub highlight_style
 pub diagnostic_severity
 pub is_unnecessary
 pub is_tab
 pub renderer
pub struct ChunkRenderer
 pub render
 pub constrain_width
pub struct ChunkRendererContext
 pub window
 pub context
 pub max_width
impl fmt::Debug for ChunkRenderer
 fn fmt
impl Deref for ChunkRendererContext<'a, 'b>
 type Target
 fn deref
impl DerefMut for ChunkRendererContext<'a, 'b>
 fn deref_mut
pub struct Diff
 pub(crate) base_version
 line_ending
 pub edits
pub(crate) struct DiagnosticEndpoint
 offset
 is_start
 severity
 is_unnecessary
pub enum CharKind
 Whitespace
 Punctuation
 Word
pub struct Runnable
 pub tags
 pub language
 pub buffer
pub struct EditPreview
 old_snapshot
 applied_edits_snapshot
 syntax_snapshot
pub struct HighlightedEdits
 pub text
 pub highlights
impl EditPreview
 pub fn highlight_edits
 pub fn highlight_edits_in_range
 fn highlight_text
 fn highlighted_chunks
 fn compute_visible_range
impl Buffer
 pub fn local
 pub fn local_normalized
 pub fn remote
 pub fn from_proto
 pub fn to_proto
 pub fn serialize_ops
 pub fn with_language
 pub fn capability
 pub fn read_only
 pub fn build
 pub fn build_snapshot
 pub fn snapshot
 pub fn branch
 pub fn preview_edits
 pub fn merge_into_base
 fn on_base_buffer_event
 pub(crate) fn as_text_snapshot
 pub fn text_snapshot
 pub fn file
 pub fn saved_version
 pub fn saved_mtime
 pub fn set_language
 pub fn set_language_registry
 pub fn language_registry
 pub fn set_capability
 pub fn did_save
 pub fn discarded
 pub fn reload
 pub fn did_reload
 pub fn file_updated
 pub fn base_buffer
 pub fn language
 pub fn language_at
 pub fn non_text_state_update_count
 pub fn is_parsing
 pub fn contains_unknown_injections
 pub fn set_sync_parse_timeout
 pub fn reparse
 fn did_finish_parsing
 pub fn parse_status
 pub fn update_diagnostics
 fn request_autoindent
 fn compute_autoindents
 fn apply_autoindents
 pub fn edit_for_indent_size_adjustment
 pub fn diff
 pub fn remove_trailing_whitespace
 pub fn ensure_final_newline
 pub fn apply_diff
 fn has_unsaved_edits
 pub fn is_dirty
 pub fn has_conflict
 pub fn subscribe
 pub fn start_transaction
 pub fn start_transaction_at
 pub fn end_transaction
 pub fn end_transaction_at
 pub fn push_transaction
 pub fn finalize_last_transaction
 pub fn group_until_transaction
 pub fn forget_transaction
 pub fn merge_transactions
 pub fn wait_for_edits
 pub fn wait_for_anchors
 pub fn wait_for_version
 pub fn give_up_waiting
 pub fn set_active_selections
 pub fn remove_active_selections
 pub fn set_text
 pub fn edit
 fn did_edit
 pub fn autoindent_ranges
 pub fn insert_empty_line
 pub fn apply_ops
 fn flush_deferred_ops
 pub fn has_deferred_ops
 fn can_apply_op
 fn apply_op
 fn apply_diagnostic_update
 fn send_operation
 pub fn remove_peer
 pub fn undo
 pub fn undo_transaction
 pub fn undo_to_transaction
 pub fn undo_operations
 pub fn redo
 pub fn redo_to_transaction
 pub fn set_completion_triggers
 pub fn completion_triggers
 pub fn refresh_preview
 pub fn preserve_preview
impl Buffer
 pub fn edit_via_marked_text
 pub fn set_group_interval
 pub fn randomly_edit
 pub fn randomly_undo_redo
impl EventEmitter<BufferEvent> for Buffer
impl Deref for Buffer
 type Target
 fn deref
impl BufferSnapshot
 pub fn indent_size_for_line
 pub fn language_indent_size_at
 pub fn suggested_indents
 fn suggest_autoindents
 fn prev_non_blank_row
 fn get_highlights
 pub fn chunks
 fn for_each_line
 pub fn syntax_layers
 pub fn syntax_layer_at
 pub fn language
 pub fn language_at
 pub fn settings_at
 pub fn char_classifier_at
 pub fn language_scope_at
 pub fn surrounding_word
 pub fn syntax_ancestor
 pub fn outline
 pub fn symbols_containing
 pub fn outline_range_containing
 pub fn outline_items_containing
 fn next_outline_item
 pub fn function_body_fold_ranges
 pub fn matches
 pub fn bracket_ranges
 pub fn text_object_ranges
 pub fn enclosing_bracket_ranges
 pub fn innermost_enclosing_bracket_ranges
 pub fn redacted_ranges
 pub fn injections_intersecting_range
 pub fn runnable_ranges
 pub fn selections_in_range
 pub fn has_diagnostics
 pub fn diagnostics_in_range
 pub fn diagnostic_groups
 pub fn diagnostic_group
 pub fn non_text_state_update_count
 pub fn file
 pub fn resolve_file_path
fn indent_size_for_line
fn indent_size_for_text
impl Clone for BufferSnapshot
 fn clone
impl Deref for BufferSnapshot
 type Target
 fn deref
impl Send for BufferChunks<'a>
impl BufferChunks<'a>
 pub(crate) fn new
 pub fn seek
 fn initialize_diagnostic_endpoints
 pub fn offset
 pub fn range
 fn update_diagnostic_depths
 fn current_diagnostic_severity
 fn current_code_is_unnecessary
impl Iterator for BufferChunks<'a>
 type Item
 fn next
impl operation_queue::Operation for Operation
 fn lamport_timestamp
impl Default for Diagnostic
 fn default
impl IndentSize
 pub fn spaces
 pub fn tab
 pub fn chars
 pub fn char
 pub fn with_delta
 pub fn len_with_expanded_tabs
pub struct TestFile
 pub path
 pub root_name
impl File for TestFile
 fn path
 fn full_path
 fn as_local
 fn disk_state
 fn file_name
 fn worktree_id
 fn as_any
 fn to_proto
 fn is_private
pub(crate) fn contiguous_ranges
pub struct CharClassifier
 scope
 for_completion
 ignore_punctuation
impl CharClassifier
 pub fn new
 pub fn for_completion
 pub fn ignore_punctuation
 pub fn is_whitespace
 pub fn is_word
 pub fn is_punctuation
 pub fn kind_with
 pub fn kind
pub fn trailing_whitespace_ranges
```

</outline>
<rejected>
```zed/crates/language/src/buffer.rs
#[derive(Clone)]
pub struct EditPreview {
    old_snapshot: text::BufferSnapshot,
    applied_edits_snapshot: text::BufferSnapshot,
    syntax_snapshot: SyntaxSnapshot,
}

#[derive(Default, Clone, Debug)]
pub struct HighlightedEdits {
    pub text: SharedString,
    pub highlights: Vec<(Range<usize>, HighlightStyle)>,
}

impl EditPreview {
    pub fn highlight_edits(
        &self,
        current_snapshot: &BufferSnapshot,
        edits: &[(Range<Anchor>, String)],
<|editable_region_start|>
        include_deletions: bool,
        cx: &App,
    ) -> HighlightedEdits {
        let Some(visible_range_in_preview_snapshot) = self.compute_visible_range(edits) else {
            return HighlightedEdits::default();
        };
        highlight_edits_in_range(
            current_snapshot,
            visible_range_in_preview_snapshot,
            edits,
            include_deletions,
            cx,
        )
    }
    
    pub fn highlight_edits_in_range(
        &self,
        current_snapshot: &BufferSnapshot,
        visible_range_in_preview_snapshot: Range<usize>,
        edits: &[(Range<Anchor>, String)],
        include_deletions: bool,
        cx: &App,
    ) -> HighlightedEdits {
        let mut text = String::new();
        let mut highlights = Vec::new();

        let mut offset_in_preview_snapshot = visible_range_in_preview_snapshot.start;

        let insertion_highlight_style = HighlightStyle {
            background_color: Some(cx.theme().status().created_background),
            ..Default::default()
        };
        let deletion_highlight_style = HighlightStyle {
<|editable_region_end|>
            background_color: Some(cx.theme().status().deleted_background),
            ..Default::default()
        };

        for (range, edit_text) in edits {
            let edit_new_end_in_preview_snapshot = range
                .end
                .bias_right(&self.old_snapshot)
                .to_offset(&self.applied_edits_snapshot);
            let edit_start_in_preview_snapshot = edit_new_end_in_preview_snapshot - edit_text.len();

            if visible_range_in_preview_snapshot.end < edit_start_in_preview_snapshot {
                break;
            }
```
</rejected>

<labels>
local-edit,complete-pattern
</labels>
