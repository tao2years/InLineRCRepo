<events>
User edited "crates/git/src/diff.rs":
```diff
@@ -595,7 +595,7 @@
             "
             .unindent(),
         );
-        let diff_5 = BufferDiff::build(Some(&base_text, &buffer);
+        let diff_5 = BufferDiff::build(Some(&base_text), &buffer);
         let range = diff_5.compare(&diff_4, &buffer).unwrap();
         assert_eq!(range.to_point(&buffer), Point::new(3, 0)..Point::new(4, 0));
 

```
</events>
<input>
```crates/git/src/diff.rs
                SIX.5
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_3 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_3.compare(&diff_2, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(1, 0)..Point::new(2, 0));

        // Edit turns a modification hunk into a deletion.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
                four
                five«»
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_4 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_4.compare(&diff_3, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(3, 4)..Point::new(4, 0));

<|editable_region_start|>
        // Edit introduces a new insertion hunk.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
                four«
                FOUR.5
                »five
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_5 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_5.compare(&diff_4, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(3, 0)..Point::new(4, 0));

        // Edit removes a hunk.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
        <|user_cursor_is_here|>        four
                FOUR.5
<|editable_region_end|>
                five
                seven
                eight
                «nine»
            "
            .unindent(),
        );
        let diff_6 = BufferDiff::build(&base_text, &buffer);
        let range = diff_6.compare(&diff_5, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(7, 0)..Point::new(8, 0));
    }
}

```
</input>
<output>
```crates/git/src/diff.rs
                SIX.5
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_3 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_3.compare(&diff_2, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(1, 0)..Point::new(2, 0));

        // Edit turns a modification hunk into a deletion.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
                four
                five«»
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_4 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_4.compare(&diff_3, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(3, 4)..Point::new(4, 0));

<|editable_region_start|>
        // Edit introduces a new insertion hunk.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
                four«
                FOUR.5
                »five
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_5 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_5.compare(&diff_4, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(3, 0)..Point::new(4, 0));

        // Edit removes a hunk.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
                four
                FOUR.5
<|editable_region_end|>
                five
                seven
                eight
                «nine»
            "
            .unindent(),
        );
        let diff_6 = BufferDiff::build(&base_text, &buffer);
        let range = diff_6.compare(&diff_5, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(7, 0)..Point::new(8, 0));
    }
}

```
</output>
<outline>
```crates/git/src/diff.rs
pub enum DiffHunkStatus
 Added
 Modified
 Removed
pub struct DiffHunk
 pub row_range
 pub buffer_range
 pub diff_base_byte_range
struct InternalDiffHunk
 buffer_range
 diff_base_byte_range
impl sum_tree::Item for InternalDiffHunk
 type Summary
 fn summary
pub struct DiffHunkSummary
 buffer_range
impl sum_tree::Summary for DiffHunkSummary
 type Context
 fn zero
 fn add_summary
pub struct BufferDiff
 tree
impl BufferDiff
 pub fn new
 pub fn build
 pub fn is_empty
 pub fn hunks_in_row_range
 pub fn hunks_intersecting_range
 pub fn hunks_intersecting_range_rev
 pub fn compare
 fn clear
 pub fn update
 fn hunks
 fn diff
 fn process_patch_hunk
pub fn assert_hunks
mod tests
 fn test_buffer_diff_simple
 fn test_buffer_diff_range
 fn test_buffer_diff_compare
```

</outline>
<rejected>
```crates/git/src/diff.rs
                SIX.5
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_3 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_3.compare(&diff_2, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(1, 0)..Point::new(2, 0));

        // Edit turns a modification hunk into a deletion.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
                four
                five«»
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_4 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_4.compare(&diff_3, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(3, 4)..Point::new(4, 0));

<|editable_region_start|>
        // Edit introduces a new insertion hunk.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
                four«
                FOUR.5
                »five
                seven
                eight
                NINE
            "
            .unindent(),
        );
        let diff_5 = BufferDiff::build(Some(&base_text), &buffer);
        let range = diff_5.compare(&diff_4, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(3, 0)..Point::new(4, 0));

        // Edit removes a hunk.
        buffer.edit_via_marked_text(
            &"
                one
                THREE
        <|editable_region_end|>
                five
                seven
                eight
                «nine»
            "
            .unindent(),
        );
        let diff_6 = BufferDiff::build(&base_text, &buffer);
        let range = diff_6.compare(&diff_5, &buffer).unwrap();
        assert_eq!(range.to_point(&buffer), Point::new(7, 0)..Point::new(8, 0));
    }
}

```
</rejected>

<labels>
local-edit,complete-pattern
</labels>
