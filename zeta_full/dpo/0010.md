<events>
User edited "crates/terminal/src/rate_limited_sender.rs":
```diff
@@ -8,6 +8,8 @@
     last_time_sent: Instant,
 }
 
+pub fn
+
 impl<T> RateLimitedSender<T> {
     pub fn new(min_wait: Duration, max_wait: Duration, sender: Sender<T>) -> RateLimitedSender<T> {
         let now = Instant::now();

```
</events>
<input>
```crates/terminal/src/rate_limited_sender.rs
<|start_of_file|>
use tokio::sync::mpsc::{self, Receiver, Sender};

pub struct RateLimitedSender<T> {
    sender: Sender<T>,
<|editable_region_start|>
    min_wait: Duration,
    max_wait: Duration,
    last_time_called: Instant,
    last_time_sent: Instant,
}

pub fn<|user_cursor_is_here|>

impl<T> RateLimitedSender<T> {
    pub fn new(min_wait: Duration, max_wait: Duration, sender: Sender<T>) -> RateLimitedSender<T> {
        let now = Instant::now();
        let old_time = now.checked_sub(min_wait.max(max_wait)).unwrap_or(now);
        Self {
            sender: Arc::new(Mutex::new(None)),
            min_wait,
            max_wait,
<|editable_region_end|>
            last_time_called: old_time,
            last_time_sent: old_time,
        }
    }
}

```
</input>
<output>
```crates/terminal/src/rate_limited_sender.rs
<|start_of_file|>
use tokio::sync::mpsc::{self, Receiver, Sender};

pub struct RateLimitedSender<T> {
    sender: Sender<T>,
<|editable_region_start|>
    min_wait: Duration,
    max_wait: Duration,
    last_time_called: Instant,
    last_time_sent: Instant,
}

pub fn create<T>() -> (RateLimitedSender<T>, Receiver<T>) {
    let (sender, receiver) = mpsc::channel();
    let rate_limited_sender = RateLimitedSender::new(
        Duration::from_millis(100),  // default min wait
        Duration::from_secs(1),      // default max wait
        sender,
    );
    (rate_limited_sender, receiver)
}

impl<T> RateLimitedSender<T> {
    pub fn new(min_wait: Duration, max_wait: Duration, sender: Sender<T>) -> RateLimitedSender<T> {
        let now = Instant::now();
        let old_time = now.checked_sub(min_wait.max(max_wait)).unwrap_or(now);
        Self {
            sender: Arc::new(Mutex::new(None)),
            min_wait,
            max_wait,
<|editable_region_end|>
            last_time_called: old_time,
            last_time_sent: old_time,
        }
    }
}

```
</output>
<outline>
```crates/terminal/src/rate_limited_sender.rs
pub struct RateLimitedSender
 sender
 min_wait
 max_wait
 last_time_called
 last_time_sent
pub fn new
```

</outline>
<rejected>
```crates/terminal/src/rate_limited_sender.rs
<|start_of_file|>
use tokio::sync::mpsc::{self, Receiver, Sender};

pub struct RateLimitedSender<T> {
    sender: Sender<T>,
<|editable_region_start|>
    min_wait: Duration,
    max_wait: Duration,
    last_time_called: Instant,
    last_time_sent: Instant,
}

pub fn new(min_wait: Duration, max_wait: Duration, sender: Sender<T>) -> RateLimitedSender<T> {
    let now = Instant::now();
    let old_time = now.checked_sub(min_wait.max(max_wait)).unwrap_or(now);
    Self {
        sender: Arc::new(Mutex::new(None)),
        min_wait,
        max_wait,
<|editable_region_end|>
            last_time_called: old_time,
            last_time_sent: old_time,
        }
    }
}

```
</rejected>

<labels>
local-edit,complete-pattern
</labels>
