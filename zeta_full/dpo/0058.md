<events>
User edited "crates/gpui/src/platform.rs":
```diff
@@ -791,6 +791,7 @@
     }
 
     pub fn character_index_for_point(&mut self, point: Point<Pixels>) -> Option<usize> {
+        self.c
         self.handler.character_index_for_point(point, window, cx)
     }
 }

```
</events>
<input>
```crates/gpui/src/platform.rs
            .ok();
    }

    fn bounds_for_range(&mut self, range_utf16: Range<usize>) -> Option<Bounds<Pixels>> {
        self.cx
            .update(|window, cx| self.handler.bounds_for_range(range_utf16, window, cx))
            .ok()
            .flatten()
    }

    #[allow(dead_code)]
    fn apple_press_and_hold_enabled(&mut self) -> bool {
        self.handler.apple_press_and_hold_enabled()
    }

    pub(crate) fn dispatch_input(&mut self, input: &str, window: &mut Window, cx: &mut App) {
        self.handler.replace_text_in_range(None, input, window, cx);
    }

    pub fn selected_bounds(&mut self, window: &mut Window, cx: &mut App) -> Option<Bounds<Pixels>> {
        let selection = self.handler.selected_text_range(true, window, cx)?;
        self.handler.bounds_for_range(
            if selection.reversed {
                selection.range.start..selection.range.start
            } else {
                selection.range.end..selection.range.end
            },
            window,
<|editable_region_start|>
            cx,
        )
    }

    pub fn character_index_for_point(&mut self, point: Point<Pixels>) -> Option<usize> {
        self.c
        self.handler.character_index_for_point(point, window, cx)
    }
}

/// A struct representing a selection in a text buffer, in UTF16 characters.
/// This is different from a range because the head may be before the tail.
#[derive(Debug)]
pub struct UTF16Selection {
    /// The range of text in the document this selection corresponds to
    /// in UTF16 characters.
    pub range: Range<usize>,
    /// Whether the head of this selection is at the start (true), or end (false)
    /// of the range
    pu<|user_cursor_is_here|>b reversed: bool,
}

/// Zed's interface for handling text input from the platform's IME system
/// This is currently a 1:1 exposure of the NSTextInputClient API:
///
/// <https://developer.apple.com/documentation/appkit/nstextinputclient>
pub trait InputHandler: 'static {
    /// Get the range of the user's currently selected text, if any
    /// Corresponds to [selectedRange()](https://developer.apple.com/documentation/appkit/nstextinputclient/1438242-selectedrange)
    ///
    /// Return value is in terms of UTF-16 characters, from 0 to the length of the document
    fn selected_text_range(
        &mut self,
        ignore_disabled_input: bool,
        window: &mut Window,
        cx: &mut App,
<|editable_region_end|>
    ) -> Option<UTF16Selection>;

    /// Get the range of the currently marked text, if any
```
</input>
<output>
```crates/gpui/src/platform.rs
            .ok();
    }

    fn bounds_for_range(&mut self, range_utf16: Range<usize>) -> Option<Bounds<Pixels>> {
        self.cx
            .update(|window, cx| self.handler.bounds_for_range(range_utf16, window, cx))
            .ok()
            .flatten()
    }

    #[allow(dead_code)]
    fn apple_press_and_hold_enabled(&mut self) -> bool {
        self.handler.apple_press_and_hold_enabled()
    }

    pub(crate) fn dispatch_input(&mut self, input: &str, window: &mut Window, cx: &mut App) {
        self.handler.replace_text_in_range(None, input, window, cx);
    }

    pub fn selected_bounds(&mut self, window: &mut Window, cx: &mut App) -> Option<Bounds<Pixels>> {
        let selection = self.handler.selected_text_range(true, window, cx)?;
        self.handler.bounds_for_range(
            if selection.reversed {
                selection.range.start..selection.range.start
            } else {
                selection.range.end..selection.range.end
            },
            window,
<|editable_region_start|>
            cx,
        )
    }

    pub fn character_index_for_point(&mut self, point: Point<Pixels>) -> Option<usize> {
        self.cx
            .update(|window, cx| self.handler.character_index_for_point(point, window, cx))
            .ok()
            .flatten()
    }
}

/// A struct representing a selection in a text buffer, in UTF16 characters.
/// This is different from a range because the head may be before the tail.
#[derive(Debug)]
pub struct UTF16Selection {
    /// The range of text in the document this selection corresponds to
    /// in UTF16 characters.
    pub range: Range<usize>,
    /// Whether the head of this selection is at the start (true), or end (false)
    /// of the range
    pub reversed: bool,
}

/// Zed's interface for handling text input from the platform's IME system
/// This is currently a 1:1 exposure of the NSTextInputClient API:
///
/// <https://developer.apple.com/documentation/appkit/nstextinputclient>
pub trait InputHandler: 'static {
    /// Get the range of the user's currently selected text, if any
    /// Corresponds to [selectedRange()](https://developer.apple.com/documentation/appkit/nstextinputclient/1438242-selectedrange)
    ///
    /// Return value is in terms of UTF-16 characters, from 0 to the length of the document
    fn selected_text_range(
        &mut self,
        ignore_disabled_input: bool,
        window: &mut Window,
        cx: &mut App,
<|editable_region_end|>
    ) -> Option<UTF16Selection>;

    /// Get the range of the currently marked text, if any
```
</output>
<outline>
```crates/gpui/src/platform.rs
mod app_menu
mod keystroke
mod linux
mod mac
mod blade
mod test
mod windows
pub(crate) fn current_platform
pub(crate) fn current_platform
pub fn guess_compositor
pub(crate) fn current_platform
pub(crate) trait Platform
 fn background_executor
 fn foreground_executor
 fn text_system
 fn run
 fn quit
 fn restart
 fn activate
 fn hide
 fn hide_other_apps
 fn unhide_other_apps
 fn displays
 fn primary_display
 fn active_window
 fn window_stack
 fn screen_capture_sources
 fn open_window
 fn window_appearance
 fn open_url
 fn on_open_urls
 fn register_url_scheme
 fn prompt_for_paths
 fn prompt_for_new_path
 fn can_select_mixed_files_and_dirs
 fn reveal_path
 fn open_with_system
 fn on_quit
 fn on_reopen
 fn on_keyboard_layout_change
 fn set_menus
 fn get_menus
 fn set_dock_menu
 fn add_recent_document
 fn on_app_menu_action
 fn on_will_open_app_menu
 fn on_validate_app_menu_command
 fn keyboard_layout
 fn compositor_name
 fn app_path
 fn path_for_auxiliary_executable
 fn set_cursor_style
 fn should_auto_hide_scrollbars
 fn write_to_primary
 fn write_to_clipboard
 fn read_from_primary
 fn read_from_clipboard
 fn write_credentials
 fn read_credentials
 fn delete_credentials
pub trait PlatformDisplay
 fn id
 fn uuid
 fn bounds
 fn default_bounds
pub trait ScreenCaptureSource
 fn resolution
 fn stream
pub trait ScreenCaptureStream
pub struct ScreenCaptureFrame
pub struct DisplayId
impl Debug for DisplayId
 fn fmt
impl Send for DisplayId
pub enum ResizeEdge
 Top
 TopRight
 Right
 BottomRight
 Bottom
 BottomLeft
 Left
 TopLeft
pub enum WindowDecorations
 Server
 Client
pub enum Decorations
 Server
 Client
  tiling
pub struct WindowControls
 pub fullscreen
 pub maximize
 pub minimize
 pub window_menu
impl Default for WindowControls
 fn default
pub struct Tiling
 pub top
 pub left
 pub right
 pub bottom
impl Tiling
 pub fn tiled
 pub fn is_tiled
pub(crate) struct RequestFrameOptions
 pub(crate) require_presentation
pub(crate) trait PlatformWindow
 fn bounds
 fn is_maximized
 fn window_bounds
 fn content_size
 fn scale_factor
 fn appearance
 fn display
 fn mouse_position
 fn modifiers
 fn set_input_handler
 fn take_input_handler
 fn prompt
 fn activate
 fn is_active
 fn is_hovered
 fn set_title
 fn set_background_appearance
 fn minimize
 fn zoom
 fn toggle_fullscreen
 fn is_fullscreen
 fn on_request_frame
 fn on_input
 fn on_active_status_change
 fn on_hover_status_change
 fn on_resize
 fn on_moved
 fn on_should_close
 fn on_close
 fn on_appearance_changed
 fn draw
 fn completed_frame
 fn sprite_atlas
 fn set_edited
 fn show_character_palette
 fn get_raw_handle
 fn inner_window_bounds
 fn request_decorations
 fn show_window_menu
 fn start_window_move
 fn start_window_resize
 fn window_decorations
 fn set_app_id
 fn window_controls
 fn set_client_inset
 fn gpu_specs
 fn update_ime_position
 fn as_test
pub trait PlatformDispatcher
 fn is_main_thread
 fn dispatch
 fn dispatch_on_main_thread
 fn dispatch_after
 fn park
 fn unparker
 fn now
 fn as_test
pub(crate) trait PlatformTextSystem
 fn add_fonts
 fn all_font_names
 fn font_id
 fn font_metrics
 fn typographic_bounds
 fn advance
 fn glyph_for_char
 fn glyph_raster_bounds
 fn rasterize_glyph
 fn layout_line
pub(crate) struct NoopTextSystem
impl NoopTextSystem
 pub fn new
impl PlatformTextSystem for NoopTextSystem
 fn add_fonts
 fn all_font_names
 fn font_id
 fn font_metrics
 fn typographic_bounds
 fn advance
 fn glyph_for_char
 fn glyph_raster_bounds
 fn rasterize_glyph
 fn layout_line
pub(crate) enum AtlasKey
 Glyph
 Svg
 Image
impl AtlasKey
 pub(crate) fn texture_kind
impl From<RenderGlyphParams> for AtlasKey
 fn from
impl From<RenderSvgParams> for AtlasKey
 fn from
impl From<RenderImageParams> for AtlasKey
 fn from
pub(crate) trait PlatformAtlas
 fn get_or_insert_with
 fn remove
struct AtlasTextureList
 textures
 free_list
impl Default for AtlasTextureList<T>
 fn default
impl ops::Index<usize> for AtlasTextureList<T>
 type Output
 fn index
impl AtlasTextureList<T>
 fn drain
 fn iter_mut
pub(crate) struct AtlasTile
 pub(crate) texture_id
 pub(crate) tile_id
 pub(crate) padding
 pub(crate) bounds
pub(crate) struct AtlasTextureId
 pub(crate) index
 pub(crate) kind
pub(crate) enum AtlasTextureKind
 Monochrome
 Polychrome
 Path
pub(crate) struct TileId
impl From<etagere::AllocId> for TileId
 fn from
impl From<TileId> for etagere::AllocId
 fn from
pub(crate) struct PlatformInputHandler
 cx
 handler
impl PlatformInputHandler
 pub fn new
 fn selected_text_range
 fn marked_text_range
 fn text_for_range
 fn replace_text_in_range
 fn replace_and_mark_text_in_range
 fn unmark_text
 fn bounds_for_range
 fn apple_press_and_hold_enabled
 pub(crate) fn dispatch_input
 pub fn selected_bounds
 pub fn character_index_for_point
pub struct UTF16Selection
 pub range
 pub reversed
pub trait InputHandler
 fn selected_text_range
 fn marked_text_range
 fn text_for_range
 fn replace_text_in_range
 fn replace_and_mark_text_in_range
 fn unmark_text
 fn bounds_for_range
 fn character_index_for_point
 fn apple_press_and_hold_enabled
pub struct WindowOptions
 pub window_bounds
 pub titlebar
 pub focus
 pub show
 pub kind
 pub is_movable
 pub display_id
 pub window_background
 pub app_id
 pub window_min_size
 pub window_decorations
pub(crate) struct WindowParams
 pub bounds
 pub titlebar
 pub kind
 pub is_movable
 pub focus
 pub show
 pub display_id
 pub window_min_size
pub enum WindowBounds
 Windowed
 Maximized
 Fullscreen
impl Default for WindowBounds
 fn default
impl WindowBounds
 pub fn get_bounds
impl Default for WindowOptions
 fn default
pub struct TitlebarOptions
 pub title
 pub appears_transparent
 pub traffic_light_position
pub enum WindowKind
 Normal
 PopUp
pub enum WindowAppearance
 Light
 VibrantLight
 Dark
 VibrantDark
impl Default for WindowAppearance
 fn default
pub enum WindowBackgroundAppearance
 Opaque
 Transparent
 Blurred
pub struct PathPromptOptions
 pub files
 pub directories
 pub multiple
pub enum PromptLevel
 Info
 Warning
 Critical
pub enum CursorStyle
 Arrow
 IBeam
 Crosshair
 ClosedHand
 OpenHand
 PointingHand
 ResizeLeft
 ResizeRight
 ResizeLeftRight
 ResizeUp
 ResizeDown
 ResizeUpDown
 ResizeUpLeftDownRight
 ResizeUpRightDownLeft
 ResizeColumn
 ResizeRow
 IBeamCursorForVerticalLayout
 OperationNotAllowed
 DragLink
 DragCopy
 ContextualMenu
impl Default for CursorStyle
 fn default
pub struct ClipboardItem
 entries
pub enum ClipboardEntry
 String
 Image
impl ClipboardItem
 pub fn new_string
 pub fn new_string_with_metadata
 pub fn new_string_with_json_metadata
 pub fn new_image
 pub fn text
 pub fn metadata
 pub fn entries
 pub fn into_entries
pub enum ImageFormat
 Png
 Jpeg
 Webp
 Gif
 Svg
 Bmp
 Tiff
pub struct Image
 pub format
 pub bytes
 pub id
impl Hash for Image
 fn hash
impl Image
 pub fn id
 pub fn use_render_image
 pub fn to_image_data
  fn frames_for_image
 pub fn format
 pub fn bytes
pub struct ClipboardString
 pub(crate) text
 pub(crate) metadata
impl ClipboardString
 pub fn new
 pub fn with_json_metadata
 pub fn text
 pub fn into_text
 pub fn metadata_json
 pub(crate) fn text_hash
```

</outline>
<rejected>
```crates/gpui/src/platform.rs
            .ok();
    }

    fn bounds_for_range(&mut self, range_utf16: Range<usize>) -> Option<Bounds<Pixels>> {
        self.cx
            .update(|window, cx| self.handler.bounds_for_range(range_utf16, window, cx))
            .ok()
            .flatten()
    }

    #[allow(dead_code)]
    fn apple_press_and_hold_enabled(&mut self) -> bool {
        self.handler.apple_press_and_hold_enabled()
    }

    pub(crate) fn dispatch_input(&mut self, input: &str, window: &mut Window, cx: &mut App) {
        self.handler.replace_text_in_range(None, input, window, cx);
    }

    pub fn selected_bounds(&mut self, window: &mut Window, cx: &mut App) -> Option<Bounds<Pixels>> {
        let selection = self.handler.selected_text_range(true, window, cx)?;
        self.handler.bounds_for_range(
            if selection.reversed {
                selection.range.start..selection.range.start
            } else {
                selection.range.end..selection.range.end
            },
            window,
<|editable_region_start|>
            cx,
        )
    }

    pub fn character_index_for_point(&mut self, point: Point<Pixels>) -> Option<usize> {
        self.handler.character_index_for_point(point, window, cx)
    }
}

/// A struct representing a selection in a text buffer, in UTF16 characters.
/// This is different from a range because the head may be before the tail.
#[derive(Debug)]
pub struct UTF16Selection {
    /// The range of text in the document this selection corresponds to
    /// in UTF16 characters.
    pub range: Range<usize>,
    /// Whether the head of this selection is at the start (true), or end (false)
    /// of the range
    pub reversed: bool,
}

/// Zed's interface for handling text input from the platform's IME system
/// This is currently a 1:1 exposure of the NSTextInputClient API:
///
/// <https://developer.apple.com/documentation/appkit/nstextinputclient>
pub trait InputHandler: 'static {
    /// Get the range of the user's currently selected text, if any
    /// Corresponds to [selectedRange()](https://developer.apple.com/documentation/appkit/nstextinputclient/1438242-selectedrange)
    ///
    /// Return value is in terms of UTF-16 characters, from 0 to the length of the document
    fn selected_text_range(
        &mut self,
        ignore_disabled_input: bool,
        window: &mut Window,
        cx: &mut App,
<|editable_region_end|>
    ) -> Option<UTF16Selection>;

    /// Get the range of the currently marked text, if any
```
</rejected>

<labels>
local-edit,complete-pattern
</labels>
