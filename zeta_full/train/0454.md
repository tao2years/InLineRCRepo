<rating>Negative</rating>
<feedback>This should be a no-op.</feedback>
<events>
User edited "crates/zeta/src/zeta.rs":
```diff
@@ -564,6 +565,7 @@
         output_excerpt: String,
         snapshot: &BufferSnapshot,
         excerpt_range: Range<usize>,
+        cursor_offset: usize,
         path: Arc<Path>,
         input_outline: String,
         input_events: String,

```

User edited "crates/zeta/src/rate_completion_modal.rs":
```diff
@@ -275,6 +275,7 @@
             .text_for_range(active_completion.completion.excerpt_range.clone())
             .collect::<String>();

+
         let mut delta = 0;
         let mut diff_highlights = Vec::new();
         for (old_range, new_text) in active_completion.completion.edits.iter() {

```
</events>
<input>
```crates/zeta/src/rate_completion_modal.rs
            completion,
            feedback_editor: cx.new_view(|cx| {
                let mut editor = Editor::multi_line(cx);
                editor.set_soft_wrap_mode(language_settings::SoftWrap::EditorWidth, cx);
                editor.set_show_line_numbers(false, cx);
                editor.set_show_scrollbars(false, cx);
                editor.set_show_git_diff_gutter(false, cx);
<|editable_region_start|>
                editor.set_show_code_actions(false, cx);
                editor.set_show_runnables(false, cx);
                editor.set_show_wrap_guides(false, cx);
                editor.set_show_indent_guides(false, cx);
                editor.set_show_inline_completions(Some(false), cx);
                editor.set_placeholder_text("Add your feedback…", cx);
                if focus {
                    cx.focus_self();
                }
                editor
            }),
        });
        cx.notify();
    }

    fn render_active_completion(&mut self, cx: &mut ViewContext<Self>) -> Option<impl IntoElement> {
        let active_completion = self.active_completion.as_ref()?;
        let completion_id = active_completion.completion.id;
        let focus_handle = &self.focus_handle(cx);

        let mut diff = active_completion
            .completion
            .snapshot
            .text_for_range(active_completion.completion.excerpt_range.clone())
            .collect::<String>();

<|user_cursor_is_here|>
        let mut delta = 0;
        let mut diff_highlights = Vec::new();
        for (old_range, new_text) in active_completion.completion.edits.iter() {
            let old_range = old_range.to_offset(&active_completion.completion.snapshot);
            let old_start_in_text =
                old_range.start - active_completion.completion.excerpt_range.start + delta;
            let old_end_in_text =
                old_range.end - active_completion.completion.excerpt_range.start + delta;
            if old_start_in_text < old_end_in_text {
                diff_highlights.push((
                    old_start_in_text..old_end_in_text,
                    HighlightStyle {
                        background_color: Some(cx.theme().status().deleted_background),
                        strikethrough: Some(gpui::StrikethroughStyle {
                            thickness: px(1.),
                            color: Some(cx.theme().colors().text_muted),
                        }),
                        ..Default::default()
                    },
                ));
            }

            if !new_text.is_empty() {
                diff.insert_str(old_end_in_text, new_text);
                diff_highlights.push((
                    old_end_in_text..old_end_in_text + new_text.len(),
                    HighlightStyle {
                        background_color: Some(cx.theme().status().created_background),
                        ..Default::default()
                    },
<|editable_region_end|>
                ));
                delta += new_text.len();
            }
```
</input>
<output>
```crates/zeta/src/rate_completion_modal.rs
            completion,
            feedback_editor: cx.new_view(|cx| {
                let mut editor = Editor::multi_line(cx);
                editor.set_soft_wrap_mode(language_settings::SoftWrap::EditorWidth, cx);
                editor.set_show_line_numbers(false, cx);
                editor.set_show_scrollbars(false, cx);
                editor.set_show_git_diff_gutter(false, cx);
<|editable_region_start|>
                editor.set_show_code_actions(false, cx);
                editor.set_show_runnables(false, cx);
                editor.set_show_wrap_guides(false, cx);
                editor.set_show_indent_guides(false, cx);
                editor.set_show_inline_completions(Some(false), cx);
                editor.set_placeholder_text("Add your feedback…", cx);
                if focus {
                    cx.focus_self();
                }
                editor
            }),
        });
        cx.notify();
    }

    fn render_active_completion(&mut self, cx: &mut ViewContext<Self>) -> Option<impl IntoElement> {
        let active_completion = self.active_completion.as_ref()?;
        let completion_id = active_completion.completion.id;
        let focus_handle = &self.focus_handle(cx);

        let mut diff = active_completion
            .completion
            .snapshot
            .text_for_range(active_completion.completion.excerpt_range.clone())
            .collect::<String>();

        let mut cursor_offset = 0;
        let mut delta = 0;
        let mut diff_highlights = Vec::new();
        for (old_range, new_text) in active_completion.completion.edits.iter() {
            let old_range = old_range.to_offset(&active_completion.completion.snapshot);
            let old_start_in_text =
                old_range.start - active_completion.completion.excerpt_range.start + delta;
            let old_end_in_text =
                old_range.end - active_completion.completion.excerpt_range.start + delta;
            if old_start_in_text < old_end_in_text {
                diff_highlights.push((
                    old_start_in_text..old_end_in_text,
                    HighlightStyle {
                        background_color: Some(cx.theme().status().deleted_background),
                        strikethrough: Some(gpui::StrikethroughStyle {
                            thickness: px(1.),
                            color: Some(cx.theme().colors().text_muted),
                        }),
                        ..Default::default()
                    },
                ));
            }

            if !new_text.is_empty() {
                diff.insert_str(old_end_in_text, new_text);
                diff_highlights.push((
                    old_end_in_text..old_end_in_text + new_text.len(),
                    HighlightStyle {
                        background_color: Some(cx.theme().status().created_background),
                        ..Default::default()
                    },
<|editable_region_end|>
                ));
                delta += new_text.len();
            }
```
</output>
<outline>
```crates/zeta/src/rate_completion_modal.rs
pub fn init
pub struct RateCompletionModal
 zeta
 active_completion
 selected_index
 focus_handle
 _subscription
struct ActiveCompletion
 completion
 feedback_editor
impl RateCompletionModal
 pub fn toggle
 pub fn new
 fn dismiss
 fn select_next
 fn select_prev
 fn select_next_edit
 fn select_prev_edit
 fn select_first
 fn select_last
 fn thumbs_up_active
 fn thumbs_down_active
 fn focus_completions
 fn preview_completion
 fn confirm
 pub fn select_completion
 fn render_active_completion
impl Render for RateCompletionModal
 fn render
impl EventEmitter<DismissEvent> for RateCompletionModal
impl FocusableView for RateCompletionModal
 fn focus_handle
impl ModalView for RateCompletionModal
fn format_time_ago
```

</outline>

<labels>
local-edit,infer-intent
</labels>
